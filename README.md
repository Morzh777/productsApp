# Products App - Менеджер товаров

Полнофункциональное React-приложение для управления товарами с современной архитектурой и декомпозированными компонентами.

## Технологический стек

**Frontend:** Next.js 15, TypeScript, Tailwind CSS, Server Actions, Zod, Headless UI  
**Backend:** NestJS, TypeScript, Prisma, PostgreSQL, Zod, Swagger  
**Infrastructure:** Nginx

## База данных

> **Важно:** База данных PostgreSQL уже развернута на сервере **Neon** и готова к использованию.  
> Локальная установка PostgreSQL не требуется - приложение подключается к облачной базе данных.

## Установка и запуск

```bash
# Клонируйте репозиторий
git clone https://github.com/Morzh777/productsApp.git
cd productsApp

# Запустите автоматическую установку и запуск
# Для Unix-систем (macOS, Linux):
./setup.sh

# Для Windows:
setup.bat
```

> **Примечание:** Скрипт автоматически установит все зависимости локально (в папки node_modules), настроит базу данных, установит и настроит Nginx (включая автоматическую установку Nginx на Windows через Chocolatey/winget), и запустит приложение. Для остановки нажмите `Ctrl+C`.
> 
> **Изоляция проекта:** Все зависимости устанавливаются локально в папки `node_modules` каждого проекта, что обеспечивает изоляцию от глобальных пакетов системы.
> 
> **Windows:** Если русский текст отображается некорректно, убедитесь что терминал поддерживает UTF-8 кодировку. Скрипт автоматически устанавливает кодировку UTF-8.

**Основной сайт:** http://localhost:8080  
**API:** http://localhost:8080/api  
**Swagger:** http://localhost:8080/swagger

## Функциональность

- ✅ **Список товаров** с сортировкой по цене, рейтингу и дате
- ✅ **Добавление товаров** с валидацией форм и модальными окнами
- ✅ **Редактирование и удаление** товаров с подтверждением
- ✅ **Фильтрация по категориям** с интерактивными тегами
- ✅ **Детальная страница товара** с полной информацией
- ✅ **Responsive дизайн** для всех устройств
- ✅ **Декомпозированная архитектура** с переиспользуемыми компонентами
- ✅ **Централизованная обработка ошибок** и валидация
- ✅ **Swagger документация** API

## Структура проекта

```
productsApp/
├── frontend/next-app/     # Next.js приложение
└── backend/nest-api/      # NestJS API
```

## Переменные окружения

> **Примечание:** При использовании `./setup.sh` файлы .env создаются автоматически

### Backend (.env)
```env
# Подключение к облачной базе данных Neon
DATABASE_URL="postgresql://neondb_owner:npg_vGY5fHwSoqZ9@ep-wandering-king-agz11e0s-pooler.c-2.eu-central-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require&connection_limit=5&pool_timeout=20&connect_timeout=60"
PORT=3002
NODE_ENV=production
```

### Frontend (.env.local)
```env
NEXT_PUBLIC_API_URL=http://localhost:8080/api
```

## Основные команды

```bash
# Установка всех зависимостей
npm run install:all

# Запуск backend
cd backend/nest-api && npm run start:dev

# Запуск frontend  
cd frontend/next-app && npm run dev
```

## Архитектура компонентов

### UI Компоненты
- **ProductCard** - карточка товара с изображением, рейтингом и ценой
- **ProductImage** - изображение товара с fallback и поддержкой children
- **StarRating** - звездный рейтинг с пиксельными изображениями
- **CategoryTag** - интерактивный тег категории с фильтрацией
- **SortSelect** - выбор сортировки с Headless UI
- **Button** - универсальная кнопка с множественными вариантами

### Формы и модальные окна
- **ProductForm** - декомпозированная форма товара с валидацией
- **CreateModal/EditModal/DeleteModal** - модальные окна для CRUD операций
- **FormActions** - кнопки действий формы
- **TextField/NumberField/TextAreaField/CategoryField** - переиспользуемые поля

### Утилиты и хуки
- **useProductForm** - хук для управления состоянием формы
- **useProductQueryState** - синхронизация состояния с URL параметрами
- **ErrorHandler** - централизованная обработка ошибок
- **Zod схемы** - валидация данных на клиенте и сервере

## Особенности архитектуры

- **Nginx** - проксирование запросов с сжатием (кеширование отключено)
- **Декомпозированные компоненты** - модульная архитектура с переиспользуемыми частями
- **Server Actions** с автоматической ревалидацией кеша
- **Централизованная валидация** через Zod схемы
- **Кастомные хуки** для управления состоянием форм и URL параметров
- **Headless UI** для доступных интерактивных компонентов
- **Централизованная обработка ошибок** с типизированными исключениями
- **TypeScript** для полной типизации на всех уровнях
- **Prisma ORM** для работы с PostgreSQL
- **Адаптивный дизайн** с Tailwind CSS
- **Модальные окна** для создания, редактирования и удаления товаров

---

**Автор:** Morzh777